<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - –ú–∏–Ω–∏-–±–∏–ª—å—è—Ä–¥</title>
    
    <!-- –î–æ–±–∞–≤—å—Ç–µ Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCrSNE5Irp7On5PQfiKIKWtWsmrhnhwet4",
            authDomain: "billll-29d2e.firebaseapp.com",
            databaseURL: "https://billll-29d2e-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "billll-29d2e",
            storageBucket: "billll-29d2e.firebasestorage.app",
            messagingSenderId: "120025375875",
            appId: "1:120025375875:web:eb2b736a3119b432abe7b6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        // –°–¥–µ–ª–∞–µ–º database –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
        window.database = database;
        window.dbRef = ref;
        window.dbOnValue = onValue;
        window.dbSet = set;
    </script>
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .rules {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .table-container {
            overflow-x: auto;
            padding: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        
        th {
            background: #34495e;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e8f4f8;
        }
        
        .controls {
            padding: 20px;
            background: #ecf0f1;
        }
        
        .control-group {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        select, button {
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            font-size: 16px;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .rank-1 {
            background: #fff9c4 !important;
            font-weight: bold;
        }
        
        .rank-2 {
            background: #f5f5f5 !important;
        }
        
        .rank-3 {
            background: #ffecb3 !important;
        }
        
        .points {
            font-weight: bold;
            color: #e91e63;
        }
        
        .player-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .medal {
            font-size: 18px;
        }
        
        .gold { color: #ffd700; }
        .silver { color: #c0c0c0; }
        .bronze { color: #cd7f32; }
        
        .search-box {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-box input {
            padding-left: 40px;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
        }
        
        .sync-status {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-size: 14px;
            display: none;
        }
        
        .sync-status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèÜ –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - –ú–∏–Ω–∏-–±–∏–ª—å—è—Ä–¥</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤: –ü–æ–±–µ–¥–∞ = 2 –æ—á–∫–∞, –ü–æ—Ä–∞–∂–µ–Ω–∏–µ = 1 –æ—á–∫–æ</p>
        </header>
        
        <div class="rules">
            <strong>–ü—Ä–∞–≤–∏–ª–∞ —Ç—É—Ä–Ω–∏—Ä–∞:</strong>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>–ó–∞ –ø–æ–±–µ–¥—É –≤ –º–∞—Ç—á–µ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç <strong>2 –æ—á–∫–∞</strong></li>
                <li>–ó–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ –≤ –º–∞—Ç—á–µ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç <strong>1 –æ—á–∫–æ</strong></li>
                <li>–¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—á–∫–æ–≤</li>
                <li>–ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –æ—á–∫–æ–≤ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥</li>
            </ul>
            <div id="sync-status" class="sync-status">
                <!-- –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="table-container">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞..." onkeyup="filterPlayers()">
            </div>
            
            <table id="tournament-table">
                <thead>
                    <tr>
                        <th width="50">–ú–µ—Å—Ç–æ</th>
                        <th>–£—á–∞—Å—Ç–Ω–∏–∫</th>
                        <th width="80">–ò–≥—Ä—ã</th>
                        <th width="80">–ü–æ–±–µ–¥—ã</th>
                        <th width="80">–ü–æ—Ä–∞–∂–µ–Ω–∏—è</th>
                        <th width="80">–û—á–∫–∏</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <tr>
                        <td colspan="6" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <h3>üéØ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á</h3>
                <select id="player1">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 1</option>
                </select>
                <select id="player2">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 2</option>
                </select>
                <select id="winner">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</option>
                    <option value="player1">–ü–æ–±–µ–¥–∏–ª –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫</option>
                    <option value="player2">–ü–æ–±–µ–¥–∏–ª –≤—Ç–æ—Ä–æ–π –∏–≥—Ä–æ–∫</option>
                </select>
                <button onclick="registerMatch()">‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á</button>
            </div>
            
            <div class="control-group">
                <h3>üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                <button onclick="resetData()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º</button>
                <button onclick="exportData()">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏
        const initialPlayers = [
            "–ë—ã–≤—à–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–†–æ–≥–æ–≤ –î–º–∏—Ç—Ä–∏–π", "–ë—ã–≤—à–µ–≤–∞ –ù–∞—Ç–∞–ª—å—è", "–ë—ã–≤—à–µ–≤ –ì—Ä–∏–≥–æ—Ä–∏–π", 
            "–ë—ã–≤—à–µ–≤ –í–∏–∫—Ç–æ—Ä", "–†–æ–≥–æ–≤ –ê–ª–µ–∫—Å–µ–π", "–î–∞–Ω–∏–ª–æ–≤–∞ –û–ª—å–≥–∞", "–†–æ–≥–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è", 
            "–ë–∞—Ä—Ç–æ–∫ –û–ª—å–≥–∞", "–†–æ–≥–æ–≤ –†–æ–º–∞–Ω", "–†–æ–≥–æ–≤–∞ –õ–∏–ª–∏—è", "–ú—É—Ö—Ç–∞—Ä–æ–≤ –î–∞–Ω–∏–∏–ª", 
            "–ú—É—Ö—Ç–∞—Ä–æ–≤ –ò–ª—å—è", "–ú—É—Ö—Ç–∞—Ä–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è", "–ù–æ–≤–æ—Å–µ–ª–æ–≤ –î–∞–Ω–∏–∏–ª", "–†–æ–º–∞–Ω–æ–≤–∞ –ê–Ω—Ç–æ–Ω–∏–Ω–∞", 
            "–°–æ–∫–æ–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π", "–°–æ–∫–æ–ª–æ–≤–∞ –ê–ª–µ–Ω–∞", "–ö–∏—Ä–∏—á–µ–Ω–∫–æ –ò–ª—å—è", "–£—Ç–∫–∏–Ω –î–º–∏—Ç—Ä–∏–π", 
            "–£—Ç–∫–∏–Ω–∞ –ú–∞—Ä–∏—è", "–°–æ—Ä–æ–∫–∏–Ω–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ú—è–≥–∫–∏—Ö –í–ª–∞–¥", "–ö–∞—Ä–ø–æ–≤–∞ –õ—é–±–æ–≤—å", 
            "–°–ª–∞–≤–Ω–æ–≤–∞ –õ—é–±–æ–≤—å", "–ü—É–∑–∏–∫–æ–≤ –†–æ–º–∞–Ω", "–ë–æ–±–∫–æ–≤–∞ –°–≤–µ—Ç–ª–∞–Ω–∞", "–®–∏–≥–∞–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", 
            "–ö–∞—Ä–∞–Ω–¥–∞—à–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–£—Å–∫–æ–≤–∞ –ê–Ω–Ω–∞", "–ë–µ–∫–µ–∑–∏–Ω –Ø—Ä–æ—Å–ª–∞–≤", "–ë–µ–ª—è–∫–æ–≤ –ò–≤–∞–Ω", 
            "–§—ë–¥–æ—Ä–æ–≤ –ò–ª—å—è", "–ó–∞—Ö–∞—Ä–∏–∫–æ–≤–∞ –õ—é–±–æ–≤—å", "–ñ—ë–ª—É–¥–µ–≤–∞ –ú–∞—Ä–∏–Ω–∞", "–ú—É—Ö—Ç–∞—Ä–æ–≤ –≠–¥–≥–∞—Ä"
        ];

        let players = [];
        let currentSearch = '';

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        function showSyncStatus(message, isError = false) {
            const statusElement = document.getElementById('sync-status');
            statusElement.textContent = message;
            statusElement.style.display = 'block';
            
            if (isError) {
                statusElement.classList.add('error');
            } else {
                statusElement.classList.remove('error');
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞
            if (!isError) {
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 3000);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Firebase
        function loadData() {
            const playersRef = window.dbRef(window.database, 'players');
            
            window.dbOnValue(playersRef, (snapshot) => {
                const data = snapshot.val();
                
                if (data) {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤
                    players = Object.values(data);
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Ä—è–¥–æ–∫ –ø–æ ID
                    players.sort((a, b) => a.id - b.id);
                    showSyncStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –æ–±–ª–∞–∫–∞');
                } else {
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ Firebase
                    players = initialPlayers.map((name, index) => ({
                        id: index + 1,
                        name: name,
                        games: 0,
                        wins: 0,
                        losses: 0,
                        points: 0
                    }));
                    saveDataToFirebase();
                    showSyncStatus('‚úÖ –°–æ–∑–¥–∞–Ω—ã –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                }
                
                updateTable();
                updatePlayerSelects();
            }, (error) => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showSyncStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', true);
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Firebase
        function saveDataToFirebase() {
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–∞—Å—Å–∏–≤ –≤ –æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–∞–º–∏ –ø–æ ID –¥–ª—è Firebase
            const playersObject = {};
            players.forEach(player => {
                playersObject[player.id] = player;
            });
            
            const playersRef = window.dbRef(window.database, 'players');
            
            window.dbSet(playersRef, playersObject)
                .then(() => {
                    console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Firebase');
                    showSyncStatus('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –æ–±–ª–∞–∫–æ');
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                    showSyncStatus('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö', true);
                });
        }

        // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º
        function resetData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º? –í—Å–µ —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
                players = initialPlayers.map((name, index) => ({
                    id: index + 1,
                    name: name,
                    games: 0,
                    wins: 0,
                    losses: 0,
                    points: 0
                }));
                saveDataToFirebase();
                showNotification('–î–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º');
            }
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function exportData() {
            const dataStr = JSON.stringify(players, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'tournament-data.json';
            link.click();
            
            showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –ø–æ–∏—Å–∫—É
        function filterPlayers() {
            currentSearch = document.getElementById('search-input').value.toLowerCase();
            updateTable();
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ç—á–∞
        function registerMatch() {
            const player1Select = document.getElementById('player1');
            const player2Select = document.getElementById('player2');
            const winnerSelect = document.getElementById('winner');
            
            const player1Id = parseInt(player1Select.value);
            const player2Id = parseInt(player2Select.value);
            const winner = winnerSelect.value;
            
            if (!player1Id || !player2Id || !winner) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Ç—á–∞');
                return;
            }
            
            if (player1Id === player2Id) {
                alert('–ò–≥—Ä–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –∏–≥—Ä–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ —Å–µ–±—è');
                return;
            }
            
            const player1 = players.find(p => p.id === player1Id);
            const player2 = players.find(p => p.id === player2Id);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            player1.games++;
            player2.games++;
            
            if (winner === 'player1') {
                player1.wins++;
                player2.losses++;
                player1.points += 2;
                player2.points += 1;
            } else {
                player2.wins++;
                player1.losses++;
                player2.points += 2;
                player1.points += 1;
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            player1Select.value = '';
            player2Select.value = '';
            winnerSelect.value = '';
            
            saveDataToFirebase();
            updateTable();
            updatePlayerSelects();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            showNotification('–ú–∞—Ç—á —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        function updateTable() {
            const tableBody = document.getElementById('table-body');
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –ø–æ–∏—Å–∫—É
            let filteredPlayers = players.filter(player => {
                if (currentSearch && !player.name.toLowerCase().includes(currentSearch)) {
                    return false;
                }
                return true;
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
            filteredPlayers = filteredPlayers.sort((a, b) => {
                if (b.points !== a.points) {
                    return b.points - a.points;
                }
                // –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –æ—á–∫–æ–≤ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ–±–µ–¥–∞–º
                return b.wins - a.wins;
            });
            
            tableBody.innerHTML = '';
            
            if (filteredPlayers.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">–£—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }
            
            filteredPlayers.forEach((player, index) => {
                const row = document.createElement('tr');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç
                if (index === 0) row.classList.add('rank-1');
                if (index === 1) row.classList.add('rank-2');
                if (index === 2) row.classList.add('rank-3');
                
                let medal = '';
                if (index === 0) medal = '<span class="medal gold">ü•á</span>';
                else if (index === 1) medal = '<span class="medal silver">ü•à</span>';
                else if (index === 2) medal = '<span class="medal bronze">ü•â</span>';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><div class="player-name">${medal} ${player.name}</div></td>
                    <td>${player.games}</td>
                    <td>${player.wins}</td>
                    <td>${player.losses}</td>
                    <td class="points">${player.points}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
        function updatePlayerSelects() {
            const player1Select = document.getElementById('player1');
            const player2Select = document.getElementById('player2');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
            const currentPlayer1 = player1Select.value;
            const currentPlayer2 = player2Select.value;
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–∫–∏
            player1Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 1</option>';
            player2Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 2</option>';
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–∫–∏ –≤—Å–µ–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏
            players.forEach(player => {
                const option1 = document.createElement('option');
                option1.value = player.id;
                option1.textContent = player.name;
                player1Select.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = player.id;
                option2.textContent = player.name;
                player2Select.appendChild(option2);
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            player1Select.value = currentPlayer1;
            player2Select.value = currentPlayer2;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                filterPlayers();
            }
        });

        // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ Firebase –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö
        window.addEventListener('DOMContentLoaded', (event) => {
            // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Firebase
            setTimeout(() => {
                if (window.database) {
                    loadData();
                } else {
                    console.error('Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                    showSyncStatus('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase', true);
                }
            }, 1000);
        });
    </script>
</body>
</html>

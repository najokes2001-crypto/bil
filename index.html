<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - –ú–∏–Ω–∏-–±–∏–ª—å—è—Ä–¥</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .rules {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .table-container {
            overflow-x: auto;
            padding: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        
        th {
            background: #34495e;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e8f4f8;
        }
        
        .controls {
            padding: 20px;
            background: #ecf0f1;
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .controls {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .control-group {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        select, button, input {
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            font-size: 16px;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        button.add {
            background: #27ae60;
        }
        
        button.add:hover {
            background: #219a52;
        }
        
        button.reset {
            background: #e74c3c;
        }
        
        button.reset:hover {
            background: #c0392b;
        }
        
        .rank-1 {
            background: #fff9c4 !important;
            font-weight: bold;
        }
        
        .rank-2 {
            background: #f5f5f5 !important;
        }
        
        .rank-3 {
            background: #ffecb3 !important;
        }
        
        .points {
            font-weight: bold;
            color: #e91e63;
        }
        
        .player-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .medal {
            font-size: 18px;
        }
        
        .gold { color: #ffd700; }
        .silver { color: #c0c0c0; }
        .bronze { color: #cd7f32; }
        
        .active-player {
            background: #d4edda !important;
        }
        
        .inactive-player {
            opacity: 0.6;
            background: #f8f9fa !important;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .filter-buttons button {
            flex: 1;
            padding: 8px;
            font-size: 14px;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-box input {
            padding-left: 40px;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèÜ –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - –ú–∏–Ω–∏-–±–∏–ª—å—è—Ä–¥</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤: –ü–æ–±–µ–¥–∞ = 2 –æ—á–∫–∞, –ü–æ—Ä–∞–∂–µ–Ω–∏–µ = 1 –æ—á–∫–æ</p>
        </header>
        
        <div class="rules">
            <strong>–ü—Ä–∞–≤–∏–ª–∞ —Ç—É—Ä–Ω–∏—Ä–∞:</strong>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>–ó–∞ –ø–æ–±–µ–¥—É –≤ –º–∞—Ç—á–µ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç <strong>2 –æ—á–∫–∞</strong></li>
                <li>–ó–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ –≤ –º–∞—Ç—á–µ –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç <strong>1 –æ—á–∫–æ</strong></li>
                <li>–¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—á–∫–æ–≤</li>
                <li>–ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –æ—á–∫–æ–≤ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥</li>
            </ul>
        </div>
        
        <div class="table-container">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞..." onkeyup="filterPlayers()">
            </div>
            <div class="filter-buttons">
                <button onclick="setFilter('all')" style="background: #3498db;">–í—Å–µ</button>
                <button onclick="setFilter('active')" style="background: #27ae60;">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                <button onclick="setFilter('inactive')" style="background: #95a5a6;">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</button>
            </div>
            
            <table id="tournament-table">
                <thead>
                    <tr>
                        <th width="50">–ú–µ—Å—Ç–æ</th>
                        <th>–£—á–∞—Å—Ç–Ω–∏–∫</th>
                        <th width="80">–ò–≥—Ä—ã</th>
                        <th width="80">–ü–æ–±–µ–¥—ã</th>
                        <th width="80">–ü–æ—Ä–∞–∂–µ–Ω–∏—è</th>
                        <th width="80">–û—á–∫–∏</th>
                        <th width="100">–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </tbody>
            </table>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h3>
                <select id="player-select" onchange="togglePlayerStatus()">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞</option>
                </select>
                <button onclick="addCustomPlayer()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞</button>
            </div>
            
            <div class="control-group">
                <h3>üéØ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á</h3>
                <select id="player1">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 1</option>
                </select>
                <select id="player2">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 2</option>
                </select>
                <select id="winner">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</option>
                    <option value="player1">–ü–æ–±–µ–¥–∏–ª –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫</option>
                    <option value="player2">–ü–æ–±–µ–¥–∏–ª –≤—Ç–æ—Ä–æ–π –∏–≥—Ä–æ–∫</option>
                </select>
                <button onclick="registerMatch()">‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á</button>
            </div>
            
            <div class="control-group" style="grid-column: 1 / -1;">
                <h3>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–º</h3>
                <button onclick="resetTournament()" class="reset">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –º–∞—Ç—á–∏</button>
                <button onclick="resetAll()" class="reset">üóëÔ∏è –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å</button>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏
        const initialPlayers = [
            "–ë—ã–≤—à–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–†–æ–≥–æ–≤ –î–º–∏—Ç—Ä–∏–π", "–ë—ã–≤—à–µ–≤–∞ –ù–∞—Ç–∞–ª—å—è", "–ë—ã–≤—à–µ–≤ –ì—Ä–∏–≥–æ—Ä–∏–π", 
            "–ë—ã–≤—à–µ–≤ –í–∏–∫—Ç–æ—Ä", "–†–æ–≥–æ–≤ –ê–ª–µ–∫—Å–µ–π", "–î–∞–Ω–∏–ª–æ–≤–∞ –û–ª—å–≥–∞", "–†–æ–≥–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è", 
            "–ë–∞—Ä—Ç–æ–∫ –û–ª—å–≥–∞", "–†–æ–≥–æ–≤ –†–æ–º–∞–Ω", "–†–æ–≥–æ–≤–∞ –õ–∏–ª–∏—è", "–ú—É—Ö—Ç–∞—Ä–æ–≤ –î–∞–Ω–∏–∏–ª", 
            "–ú—É—Ö—Ç–∞—Ä–æ–≤ –ò–ª—å—è", "–ú—É—Ö—Ç–∞—Ä–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è", "–ù–æ–≤–æ—Å–µ–ª–æ–≤ –î–∞–Ω–∏–∏–ª", "–†–æ–º–∞–Ω–æ–≤–∞ –ê–Ω—Ç–æ–Ω–∏–Ω–∞", 
            "–°–æ–∫–æ–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π", "–°–æ–∫–æ–ª–æ–≤–∞ –ê–ª–µ–Ω–∞", "–ö–∏—Ä–∏—á–µ–Ω–∫–æ –ò–ª—å—è", "–£—Ç–∫–∏–Ω –î–º–∏—Ç—Ä–∏–π", 
            "–£—Ç–∫–∏–Ω–∞ –ú–∞—Ä–∏—è", "–°–æ—Ä–æ–∫–∏–Ω–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ú—è–≥–∫–∏—Ö –í–ª–∞–¥", "–ö–∞—Ä–ø–æ–≤–∞ –õ—é–±–æ–≤—å", 
            "–°–ª–∞–≤–Ω–æ–≤–∞ –õ—é–±–æ–≤—å", "–ü—É–∑–∏–∫–æ–≤ –†–æ–º–∞–Ω", "–ë–æ–±–∫–æ–≤–∞ –°–≤–µ—Ç–ª–∞–Ω–∞", "–®–∏–≥–∞–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", 
            "–ö–∞—Ä–∞–Ω–¥–∞—à–µ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–£—Å–∫–æ–≤–∞ –ê–Ω–Ω–∞", "–ë–µ–∫–µ–∑–∏–Ω –Ø—Ä–æ—Å–ª–∞–≤", "–ë–µ–ª—è–∫–æ–≤ –ò–≤–∞–Ω", 
            "–§—ë–¥–æ—Ä–æ–≤ –ò–ª—å—è", "–ó–∞—Ö–∞—Ä–∏–∫–æ–≤–∞ –õ—é–±–æ–≤—å", "–ñ—ë–ª—É–¥–µ–≤–∞ –ú–∞—Ä–∏–Ω–∞", "–ú—É—Ö—Ç–∞—Ä–æ–≤ –≠–¥–≥–∞—Ä"
        ];

        let players = [];
        let currentFilter = 'all';
        let currentSearch = '';

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        function loadData() {
            const savedData = localStorage.getItem('tournamentData');
            if (savedData) {
                players = JSON.parse(savedData);
            } else {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
                players = initialPlayers.map((name, index) => ({
                    id: index + 1,
                    name: name,
                    games: 0,
                    wins: 0,
                    losses: 0,
                    points: 0,
                    active: true // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã
                }));
            }
            updateTable();
            updatePlayerSelects();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveData() {
            localStorage.setItem('tournamentData', JSON.stringify(players));
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤
        function filterPlayers() {
            currentSearch = document.getElementById('search-input').value.toLowerCase();
            updateTable();
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
        function setFilter(filter) {
            currentFilter = filter;
            updateTable();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        function togglePlayerStatus() {
            const select = document.getElementById('player-select');
            const playerId = parseInt(select.value);
            
            if (!playerId) return;
            
            const player = players.find(p => p.id === playerId);
            if (player) {
                player.active = !player.active;
                saveData();
                updateTable();
                updatePlayerSelects();
                select.value = '';
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        function addCustomPlayer() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è –Ω–æ–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞:');
            if (name && name.trim()) {
                const newPlayer = {
                    id: Math.max(...players.map(p => p.id)) + 1,
                    name: name.trim(),
                    games: 0,
                    wins: 0,
                    losses: 0,
                    points: 0,
                    active: true
                };
                players.push(newPlayer);
                saveData();
                updateTable();
                updatePlayerSelects();
            }
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ç—á–∞
        function registerMatch() {
            const player1Select = document.getElementById('player1');
            const player2Select = document.getElementById('player2');
            const winnerSelect = document.getElementById('winner');
            
            const player1Id = parseInt(player1Select.value);
            const player2Id = parseInt(player2Select.value);
            const winner = winnerSelect.value;
            
            if (!player1Id || !player2Id || !winner) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Ç—á–∞');
                return;
            }
            
            if (player1Id === player2Id) {
                alert('–ò–≥—Ä–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –∏–≥—Ä–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ —Å–µ–±—è');
                return;
            }
            
            const player1 = players.find(p => p.id === player1Id);
            const player2 = players.find(p => p.id === player2Id);
            
            if (!player1.active || !player2.active) {
                alert('–û–±–∞ –∏–≥—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Ç—á–∞');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            player1.games++;
            player2.games++;
            
            if (winner === 'player1') {
                player1.wins++;
                player2.losses++;
                player1.points += 2;
                player2.points += 1;
            } else {
                player2.wins++;
                player1.losses++;
                player2.points += 2;
                player1.points += 1;
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            player1Select.value = '';
            player2Select.value = '';
            winnerSelect.value = '';
            
            saveData();
            updateTable();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        function updateTable() {
            const tableBody = document.getElementById('table-body');
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤
            let filteredPlayers = players.filter(player => {
                // –ü–æ–∏—Å–∫
                if (currentSearch && !player.name.toLowerCase().includes(currentSearch)) {
                    return false;
                }
                // –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
                if (currentFilter === 'active') return player.active;
                if (currentFilter === 'inactive') return !player.active;
                return true; // 'all'
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
            filteredPlayers = filteredPlayers.sort((a, b) => {
                if (b.points !== a.points) {
                    return b.points - a.points;
                }
                // –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –æ—á–∫–æ–≤ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ–±–µ–¥–∞–º
                return b.wins - a.wins;
            });
            
            tableBody.innerHTML = '';
            
            filteredPlayers.forEach((player, index) => {
                const row = document.createElement('tr');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞
                if (player.active) {
                    row.classList.add('active-player');
                } else {
                    row.classList.add('inactive-player');
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç
                if (index === 0 && player.active) row.classList.add('rank-1');
                if (index === 1 && player.active) row.classList.add('rank-2');
                if (index === 2 && player.active) row.classList.add('rank-3');
                
                let medal = '';
                if (index === 0 && player.active) medal = '<span class="medal gold">ü•á</span>';
                else if (index === 1 && player.active) medal = '<span class="medal silver">ü•à</span>';
                else if (index === 2 && player.active) medal = '<span class="medal bronze">ü•â</span>';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><div class="player-name">${medal} ${player.name}</div></td>
                    <td>${player.games}</td>
                    <td>${player.wins}</td>
                    <td>${player.losses}</td>
                    <td class="points">${player.points}</td>
                    <td>${player.active ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ –Ω–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            if (filteredPlayers.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">–£—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
        function updatePlayerSelects() {
            const player1Select = document.getElementById('player1');
            const player2Select = document.getElementById('player2');
            const playerSelect = document.getElementById('player-select');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
            const currentPlayer1 = player1Select.value;
            const currentPlayer2 = player2Select.value;
            const currentPlayer = playerSelect.value;
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–∫–∏
            player1Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 1</option>';
            player2Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ 2</option>';
            playerSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞</option>';
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏
            players.filter(p => p.active).forEach(player => {
                const option1 = document.createElement('option');
                option1.value = player.id;
                option1.textContent = player.name;
                player1Select.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = player.id;
                option2.textContent = player.name;
                player2Select.appendChild(option2);
            });
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–º
            players.forEach(player => {
                const option = document.createElement('option');
                option.value = player.id;
                option.textContent = `${player.name} (${player.active ? '–∞–∫—Ç–∏–≤–µ–Ω' : '–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω'})`;
                playerSelect.appendChild(option);
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            player1Select.value = currentPlayer1;
            player2Select.value = currentPlayer2;
            playerSelect.value = currentPlayer;
        }

        // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∞—Ç—á–µ–π
        function resetTournament() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–∞—Ç—á–µ–π? –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω—É–ª–∏—Ç—Å—è, –Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è.')) {
                players.forEach(player => {
                    player.games = 0;
                    player.wins = 0;
                    player.losses = 0;
                    player.points = 0;
                });
                saveData();
                updateTable();
            }
        }

        // –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å
        function resetAll() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—Å–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
                players = initialPlayers.map((name, index) => ({
                    id: index + 1,
                    name: name,
                    games: 0,
                    wins: 0,
                    losses: 0,
                    points: 0,
                    active: true
                }));
                saveData();
                updateTable();
                updatePlayerSelects();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = loadData;

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
        function exportData() {
            const dataStr = JSON.stringify(players, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'tournament_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        if (confirm('–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏?')) {
                            players = importedData;
                            saveData();
                            updateTable();
                            updatePlayerSelects();
                        }
                    } catch (error) {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function addExportImportButtons() {
            const controls = document.querySelector('.control-group:last-child');
            const exportImportDiv = document.createElement('div');
            exportImportDiv.style.display = 'flex';
            exportImportDiv.style.gap = '10px';
            exportImportDiv.style.marginTop = '10px';
            
            const exportBtn = document.createElement('button');
            exportBtn.textContent = 'üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö';
            exportBtn.onclick = exportData;
            exportBtn.style.background = '#9b59b6';
            
            const importBtn = document.createElement('button');
            importBtn.textContent = 'üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö';
            importBtn.onclick = importData;
            importBtn.style.background = '#e67e22';
            
            exportImportDiv.appendChild(exportBtn);
            exportImportDiv.appendChild(importBtn);
            controls.appendChild(exportImportDiv);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö)
        setInterval(() => {
            loadData();
        }, 30000);

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        setTimeout(addExportImportButtons, 1000);
    </script>
</body>
</html>
